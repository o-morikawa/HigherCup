(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     51646,       1259]
NotebookOptionsPosition[     49680,       1226]
NotebookOutlinePosition[     50117,       1243]
CellTagsIndexPosition[     50074,       1240]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{
    RowBox[{
    "Notation", " ", "of", " ", "Cup", " ", "products", "\[IndentingNewLine]", 
     RowBox[{"A", "^", 
      RowBox[{"{", 
       RowBox[{"(", "p", ")"}], "}"}]}]}], " ", "\[Cup]", 
    RowBox[{"_i", " ", 
     RowBox[{"B", "^", 
      RowBox[{"{", 
       RowBox[{"(", "q", ")"}], "}"}]}]}], " ", "\[Cup]", 
    RowBox[{"_j", " ", 
     RowBox[{"C", "^", 
      RowBox[{"{", 
       RowBox[{"(", "r", ")"}], "}"}]}]}]}], "\[IndentingNewLine]", "=", " ", 
   
   RowBox[{
    RowBox[{"Cup", "[", 
     RowBox[{
      RowBox[{"A", "[", "p", "]"}], ",", " ", 
      RowBox[{"B", "[", "q", "]"}], ",", " ", 
      RowBox[{"C", "[", "r", "]"}]}], "]"}], "[", 
    RowBox[{"{", 
     RowBox[{"i", ",", " ", "j"}], "}"}], "]"}]}], " ", "*)"}]], "Input",
 CellChangeTimes->{{3.923706634459361*^9, 3.923706758380578*^9}, {
  3.923885119456148*^9, 3.9238851224254627`*^9}},
 CellLabel->"In[3]:=",ExpressionUUID->"142e26fa-910b-44b6-a90a-b05fb8915a21"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Cup", "[", 
    RowBox[{"x_", ",", "y__"}], "]"}], "[", 
   RowBox[{"{", "i__", "}"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"Message", "[", 
    RowBox[{"Cup", "::", "highercup"}], "]"}], "/;", 
   RowBox[{
    RowBox[{
     RowBox[{"Length", "[", 
      RowBox[{"{", 
       RowBox[{"x", ",", "y"}], "}"}], "]"}], "-", "1"}], "!=", 
    RowBox[{"Length", "[", 
     RowBox[{"{", "i", "}"}], "]"}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Cup", "::", "highercup"}], " ", "=", " ", 
   "\"\<Mismatched numbers of cup products\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Del", "[", "]"}], "=", "0"}], ";", " ", 
  RowBox[{
   RowBox[{"Del", "[", "0", "]"}], " ", "=", " ", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Cup", "[", 
    RowBox[{"x___", ",", "0", ",", "y___"}], "]"}], "[", 
   RowBox[{"{", "i__", "}"}], "]"}], ":=", "0"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Cup", "[", 
     RowBox[{"x_", ",", "y__"}], "]"}], "[", 
    RowBox[{"{", 
     RowBox[{"i___", ",", "j_", ",", "k___"}], "}"}], "]"}], ":=", 
   RowBox[{"0", "/;", 
    RowBox[{"j", "<", "0"}]}]}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", "Nilpotent", " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Del", "[", 
    RowBox[{"Del", "[", 
     RowBox[{"x_", "[", "n_", "]"}], "]"}], "]"}], " ", ":=", " ", "0"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", "Homomorphism", " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Del", "[", 
   RowBox[{"x_", "+", "y_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"Del", "[", "x", "]"}], "+", 
   RowBox[{"Del", "[", "y", "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Del", "[", 
   RowBox[{"x_", "+", " ", "y_", "+", " ", "z__"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"Del", "[", "x", "]"}], "+", 
   RowBox[{"Del", "[", "y", "]"}], "+", 
   RowBox[{"Del", "[", "z", "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Cup", "[", 
    RowBox[{"x___", ",", 
     RowBox[{"y_", "+", "z_"}], ",", "w___"}], "]"}], "[", 
   RowBox[{"{", "i__", "}"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"Cup", "[", 
     RowBox[{"x", ",", "y", ",", "w"}], "]"}], "[", 
    RowBox[{"{", "i", "}"}], "]"}], " ", "+", " ", 
   RowBox[{
    RowBox[{"Cup", "[", 
     RowBox[{"x", ",", "z", ",", "w"}], "]"}], "[", 
    RowBox[{"{", "i", "}"}], "]"}]}]}]}], "Input",
 CellChangeTimes->{{3.922953649987743*^9, 3.9229536706146517`*^9}, {
   3.922953713152493*^9, 3.9229537179022713`*^9}, {3.922953816395215*^9, 
   3.92295390709267*^9}, {3.9229540098514137`*^9, 3.922954021966577*^9}, {
   3.9236990442315073`*^9, 3.923699053600246*^9}, {3.923699187320818*^9, 
   3.923699255993054*^9}, {3.9236993666819277`*^9, 3.923699391105912*^9}, {
   3.9236995696807632`*^9, 3.923699573191156*^9}, {3.923699738826633*^9, 
   3.923699838528802*^9}, {3.9237002496813087`*^9, 3.923700267699874*^9}, {
   3.923700465088685*^9, 3.923700501048855*^9}, 3.923703192031518*^9, {
   3.9238824162878036`*^9, 3.92388246893779*^9}, 3.923882519596932*^9, {
   3.923882575873032*^9, 3.9238825973355923`*^9}, {3.923882723529447*^9, 
   3.9238827320547256`*^9}, {3.923882817683771*^9, 3.9238829034745417`*^9}, {
   3.9238829361113377`*^9, 3.9238830479104*^9}, 3.923883124913437*^9, {
   3.92388339015554*^9, 3.92388340731884*^9}, {3.923883552466241*^9, 
   3.9238835691000233`*^9}, {3.923883624487233*^9, 3.923883635388053*^9}, {
   3.923883880071765*^9, 3.9238839040647573`*^9}, {3.9238841442950697`*^9, 
   3.92388416414286*^9}, {3.923884208519889*^9, 3.923884247396359*^9}, {
   3.923884298095044*^9, 3.9238844268791924`*^9}, {3.923884461824025*^9, 
   3.923884468167379*^9}, {3.9238857706655693`*^9, 3.923885770909541*^9}, 
   3.924739301643841*^9, {3.924739364852302*^9, 3.9247393807642*^9}, {
   3.9247394238149033`*^9, 3.9247394738046007`*^9}, {3.924739530230418*^9, 
   3.924739592197011*^9}, {3.924739820527071*^9, 3.924739877326556*^9}, {
   3.924740186433139*^9, 3.924740217676115*^9}, {3.924852467320621*^9, 
   3.924852482089768*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"72ffa93e-3d60-4328-9f73-fca678062c06"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Overall", " ", "factor"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Del", "[", 
     RowBox[{"a_", " ", "*", " ", 
      RowBox[{"x_", "[", "n_", "]"}]}], "]"}], ":=", 
    RowBox[{"a", " ", "*", " ", 
     RowBox[{"Del", "[", 
      RowBox[{"x", "[", "n", "]"}], "]"}]}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Cup", "[", 
      RowBox[{"x___", ",", 
       RowBox[{"a_", " ", "*", " ", 
        RowBox[{"y_", "[", "n_", "]"}]}], ",", "z___"}], "]"}], "[", 
     RowBox[{"{", "i__", "}"}], "]"}], " ", ":=", " ", 
    RowBox[{"a", " ", "*", " ", 
     RowBox[{
      RowBox[{"Cup", "[", 
       RowBox[{"x", ",", 
        RowBox[{"y", "[", "n", "]"}], ",", "z"}], "]"}], "[", 
      RowBox[{"{", "i", "}"}], "]"}]}]}]}]}]], "Input",
 CellChangeTimes->{{3.922953649987743*^9, 3.9229536706146517`*^9}, {
   3.922953713152493*^9, 3.9229537179022713`*^9}, {3.922953816395215*^9, 
   3.92295390709267*^9}, {3.9229540098514137`*^9, 3.922954021966577*^9}, {
   3.9236990442315073`*^9, 3.923699053600246*^9}, {3.923699187320818*^9, 
   3.923699255993054*^9}, {3.9236993666819277`*^9, 3.923699391105912*^9}, {
   3.9236995696807632`*^9, 3.923699573191156*^9}, {3.923699738826633*^9, 
   3.923699838528802*^9}, 3.92388560113586*^9, {3.9238856321727247`*^9, 
   3.923885632649918*^9}, {3.923885710293804*^9, 3.923885738765333*^9}, {
   3.924577355098497*^9, 3.924577373308612*^9}, {3.924577446953127*^9, 
   3.924577464663741*^9}, {3.924577832961042*^9, 3.9245778529088717`*^9}, {
   3.924577945285056*^9, 3.924577945670808*^9}, {3.924578029161672*^9, 
   3.9245780448619633`*^9}},
 CellLabel->"In[10]:=",ExpressionUUID->"84a0f371-491f-495e-acf4-f3c1fe35a6f5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", "Associativity", " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Cup", "[", 
      RowBox[{"x__", ",", " ", 
       RowBox[{
        RowBox[{"Cup", "[", "y__", "]"}], "[", 
        RowBox[{"{", "j__", "}"}], "]"}], ",", " ", "z___"}], "]"}], "[", 
     RowBox[{"{", 
      RowBox[{"i__", ",", "k___"}], "}"}], "]"}], " ", ":=", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"Cup", "[", 
       RowBox[{"x", ",", "y", ",", "z"}], "]"}], "[", 
      RowBox[{"{", 
       RowBox[{"i", ",", "j", ",", "k"}], "}"}], "]"}], "/;", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"i", ",", "j", ",", "k"}], "}"}], "==", 
      RowBox[{"Table", "[", 
       RowBox[{"0", ",", 
        RowBox[{"Length", "[", 
         RowBox[{"{", 
          RowBox[{"i", ",", "j", ",", "k"}], "}"}], "]"}]}], "]"}]}]}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Cup", "[", 
      RowBox[{"x___", ",", " ", 
       RowBox[{
        RowBox[{"Cup", "[", "y__", "]"}], "[", 
        RowBox[{"{", "j__", "}"}], "]"}], ",", " ", "z__"}], "]"}], "[", 
     RowBox[{"{", 
      RowBox[{"i___", ",", "k__"}], "}"}], "]"}], " ", ":=", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"Cup", "[", 
       RowBox[{"x", ",", "y", ",", "z"}], "]"}], "[", 
      RowBox[{"{", 
       RowBox[{"i", ",", "j", ",", "k"}], "}"}], "]"}], "/;", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"i", ",", "j", ",", "k"}], "}"}], "==", 
      RowBox[{"Table", "[", 
       RowBox[{"0", ",", 
        RowBox[{"Length", "[", 
         RowBox[{"{", 
          RowBox[{"i", ",", "j", ",", "k"}], "}"}], "]"}]}], 
       "]"}]}]}]}]}]}]], "Input",
 CellChangeTimes->{{3.9229510506342697`*^9, 3.922951242106389*^9}, {
   3.922951833882436*^9, 3.9229518668659163`*^9}, {3.922952069762195*^9, 
   3.922952075376226*^9}, 3.9229521207794847`*^9, {3.922952275376727*^9, 
   3.922952276814567*^9}, {3.9229523146055098`*^9, 3.9229523148165627`*^9}, {
   3.922952743449923*^9, 3.92295278116822*^9}, {3.922952825611847*^9, 
   3.922952860803811*^9}, {3.922952901662424*^9, 3.922952920309495*^9}, {
   3.92295313552398*^9, 3.922953256531486*^9}, {3.9229532882249527`*^9, 
   3.922953289967348*^9}, {3.9229533343637533`*^9, 3.9229533431368437`*^9}, {
   3.922953444524582*^9, 3.922953454090087*^9}, {3.922954235751152*^9, 
   3.9229542519762*^9}, {3.923699591152326*^9, 3.923699599028824*^9}, {
   3.923699805382531*^9, 3.9236998278994493`*^9}, {3.924572310025627*^9, 
   3.9245723672955637`*^9}},
 CellLabel->"In[12]:=",ExpressionUUID->"f5fa3ec9-7584-414c-9149-5288673aa29c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Leibniz", " ", "rule"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"nform", "[", "]"}], "=", "0"}], ";", 
    RowBox[{
     RowBox[{"nform", "[", "0", "]"}], "=", "0"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"nform", "[", 
     RowBox[{"x_", "[", "n_", "]"}], "]"}], ":=", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"x", "[", 
        RowBox[{"[", "0", "]"}], "]"}], "=!=", "Cup"}], ",", "n", ",", 
      RowBox[{
       RowBox[{"Plus", "@@", 
        RowBox[{"(", 
         RowBox[{"nform", "/@", "x"}], ")"}]}], "-", 
       RowBox[{"Total", "[", "n", "]"}]}]}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"nform", "[", 
     RowBox[{"Del", "[", "x_", "]"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"nform", "[", "x", "]"}], "+", "1"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Del", "[", 
     RowBox[{
      RowBox[{"Cup", "[", 
       RowBox[{"x_", ",", "y_"}], "]"}], "[", 
      RowBox[{"{", "i_", "}"}], "]"}], "]"}], ":=", 
    RowBox[{
     RowBox[{
      RowBox[{"Cup", "[", 
       RowBox[{
        RowBox[{"Del", "[", "x", "]"}], ",", "y"}], "]"}], "[", 
      RowBox[{"{", "i", "}"}], "]"}], " ", "+", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"-", "1"}], ")"}], "^", 
       RowBox[{"nform", "[", "x", "]"}]}], " ", 
      RowBox[{
       RowBox[{"Cup", "[", 
        RowBox[{"x", ",", " ", 
         RowBox[{"Del", "[", "y", "]"}]}], "]"}], "[", 
       RowBox[{"{", "i", "}"}], "]"}]}], " ", "+", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"-", "1"}], ")"}], "^", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"nform", "[", "x", "]"}], "+", 
         RowBox[{"nform", "[", "y", "]"}], "-", "i"}], ")"}]}], " ", 
      RowBox[{
       RowBox[{"Cup", "[", 
        RowBox[{"x", ",", "y"}], "]"}], "[", 
       RowBox[{"{", 
        RowBox[{"i", "-", "1"}], "}"}], "]"}]}], " ", "+", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"-", "1"}], ")"}], "^", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"nform", "[", "x", "]"}], 
          RowBox[{"nform", "[", "y", "]"}]}], "+", 
         RowBox[{"nform", "[", "x", "]"}], "+", 
         RowBox[{"nform", "[", "y", "]"}]}], ")"}]}], " ", 
      RowBox[{
       RowBox[{"Cup", "[", 
        RowBox[{"y", ",", "x"}], "]"}], "[", 
       RowBox[{"{", 
        RowBox[{"i", "-", "1"}], "}"}], "]"}]}]}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Del", "[", 
     RowBox[{"x_", "[", "n_", "]"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"-", "1"}], ")"}], "^", 
         RowBox[{"(", 
          RowBox[{"Plus", "@@", 
           RowBox[{"(", 
            RowBox[{"nform", "/@", 
             RowBox[{"x", "[", 
              RowBox[{"[", 
               RowBox[{"1", ";;", "i"}], "]"}], "]"}]}], ")"}]}], ")"}]}], 
        RowBox[{
         RowBox[{"Flatten", "[", 
          RowBox[{
           RowBox[{"x", "[", 
            RowBox[{"[", 
             RowBox[{"1", ";;", "i"}], "]"}], "]"}], "\[Cup]", 
           RowBox[{"Del", "[", 
            RowBox[{"x", "[", 
             RowBox[{"[", 
              RowBox[{"i", "+", "1"}], "]"}], "]"}], "]"}], "\[Cup]", 
           RowBox[{"x", "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{"i", "+", "2"}], ";;", 
              RowBox[{
               RowBox[{"Length", "[", "n", "]"}], "+", "1"}]}], "]"}], 
            "]"}]}], "]"}], "[", "n", "]"}]}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"i", ",", "0", ",", 
         RowBox[{"Length", "[", "n", "]"}]}], "}"}]}], "]"}], "/;", 
     RowBox[{
      RowBox[{
       RowBox[{"x", "[", 
        RowBox[{"[", "0", "]"}], "]"}], "===", "Cup"}], "&&", 
      RowBox[{"n", "==", 
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", 
         RowBox[{"Length", "[", "n", "]"}]}], "]"}]}]}]}]}]}]}]], "Input",
 CellChangeTimes->{{3.9237009269115887`*^9, 3.923700935882183*^9}, {
   3.923701551353962*^9, 3.923701560309692*^9}, {3.923701699976474*^9, 
   3.923701781439152*^9}, {3.923702152684918*^9, 3.9237021898260527`*^9}, {
   3.9237022247579317`*^9, 3.923702234213502*^9}, {3.923702628881282*^9, 
   3.923702715198266*^9}, {3.923702846686881*^9, 3.9237028491296263`*^9}, {
   3.923702975147184*^9, 3.923702977589308*^9}, {3.923703076858377*^9, 
   3.9237031002265253`*^9}, {3.923703170969887*^9, 3.9237031712802753`*^9}, {
   3.923703225874704*^9, 3.9237032399044647`*^9}, {3.9237032787903013`*^9, 
   3.9237033966686277`*^9}, {3.923703474362446*^9, 3.9237036377235003`*^9}, {
   3.923704029211732*^9, 3.923704165963395*^9}, {3.923704273050294*^9, 
   3.9237043292081842`*^9}, {3.923704436996377*^9, 3.9237044999321938`*^9}, {
   3.9237046114564533`*^9, 3.923704616299876*^9}, {3.9237046668047523`*^9, 
   3.923704672785235*^9}, {3.9237048532855463`*^9, 3.9237048715974283`*^9}, {
   3.923704920730685*^9, 3.923704928645864*^9}, {3.923704988412228*^9, 
   3.923704990804133*^9}, {3.923705059897801*^9, 3.923705174129043*^9}, {
   3.9237053815555143`*^9, 3.92370542905832*^9}, {3.92370548041304*^9, 
   3.923705488167457*^9}, {3.923705673050642*^9, 3.923705691828947*^9}, {
   3.9238842540570803`*^9, 3.923884254651382*^9}, {3.9238845411340857`*^9, 
   3.923884620654208*^9}, {3.923884813178255*^9, 3.923884845695054*^9}, {
   3.923884880498242*^9, 3.9238849249797688`*^9}, {3.923884966682704*^9, 
   3.923884978144301*^9}, {3.9238850659689074`*^9, 3.923885104751845*^9}, {
   3.923885474723798*^9, 3.9238854841537857`*^9}, {3.923885522364357*^9, 
   3.923885523687813*^9}, {3.924572471690823*^9, 3.924572503528781*^9}, {
   3.924572536394535*^9, 3.924572651348483*^9}, {3.924572685483058*^9, 
   3.9245726905877867`*^9}, {3.9245727265389633`*^9, 
   3.9245727390069103`*^9}, {3.924572934600978*^9, 3.924572943645277*^9}, {
   3.924573077260335*^9, 3.924573100138776*^9}, {3.924573149657729*^9, 
   3.9245731652475023`*^9}, {3.924573278123418*^9, 3.924573288890326*^9}, {
   3.92457332593969*^9, 3.9245733435971746`*^9}, {3.9245735273316717`*^9, 
   3.924573528748667*^9}, {3.924573574022797*^9, 3.924573686890764*^9}, 
   3.924573732446602*^9, {3.924573937247322*^9, 3.924573940987699*^9}, {
   3.924573982685707*^9, 3.924574075055237*^9}, {3.924574156027478*^9, 
   3.924574166409501*^9}, {3.92457420956649*^9, 3.924574218039106*^9}, {
   3.924574264530505*^9, 3.924574302242114*^9}, {3.924574335519958*^9, 
   3.924574336317667*^9}, {3.9245744093975773`*^9, 3.924574419427144*^9}, 
   3.9245744497046947`*^9, {3.924574651671599*^9, 3.9245746573006163`*^9}, {
   3.924574742069524*^9, 3.924574768024001*^9}, {3.924575123342988*^9, 
   3.924575142567194*^9}, {3.924575194483364*^9, 3.924575221242611*^9}, {
   3.924575272323587*^9, 3.924575352144094*^9}, {3.9245753886181707`*^9, 
   3.9245753991769*^9}, {3.924575544057556*^9, 3.924575615611445*^9}, {
   3.924575663657765*^9, 3.924575689635725*^9}, {3.9245758498501883`*^9, 
   3.924575873655854*^9}, {3.9245761052036047`*^9, 3.924576121046145*^9}, {
   3.924576251029265*^9, 3.9245762552044687`*^9}, 3.9245763033638363`*^9, {
   3.9245764254577017`*^9, 3.9245764278418083`*^9}, {3.9245765717659187`*^9, 
   3.924576599107795*^9}, {3.924576662784955*^9, 3.924576675504327*^9}, {
   3.9245767654227133`*^9, 3.924576789643921*^9}, {3.924576844359964*^9, 
   3.924576915016086*^9}, 3.9245769530265102`*^9, {3.924577672698532*^9, 
   3.924577804503366*^9}, {3.924578127642791*^9, 3.924578137479127*^9}, {
   3.92457818691887*^9, 3.9245782137473392`*^9}, {3.924578291792301*^9, 
   3.9245783856870537`*^9}, {3.9245784670993643`*^9, 3.924578567485981*^9}, {
   3.92457868324047*^9, 3.924578860622992*^9}, {3.924578960616252*^9, 
   3.924579058837124*^9}, {3.9245791133729887`*^9, 3.924579117637072*^9}, {
   3.92457920218434*^9, 3.924579266729478*^9}, {3.924579300967003*^9, 
   3.924579329371664*^9}, {3.924579401389634*^9, 3.924579447603066*^9}, {
   3.924579500417597*^9, 3.924579527495863*^9}, {3.92457955798144*^9, 
   3.924579563486725*^9}, {3.924579694558278*^9, 3.924579713059272*^9}, {
   3.924579745813286*^9, 3.9245797702295628`*^9}, {3.9245798048855257`*^9, 
   3.924579820815316*^9}, {3.924580100364757*^9, 3.924580107005248*^9}, {
   3.924580143087315*^9, 3.924580148335271*^9}, {3.924580203764043*^9, 
   3.924580241081192*^9}, {3.924580273840619*^9, 3.9245803251939993`*^9}, {
   3.924580469280498*^9, 3.9245805171548367`*^9}, {3.9245805937791348`*^9, 
   3.924580597241444*^9}, {3.92458086872224*^9, 3.924580912083314*^9}, {
   3.92458100277483*^9, 3.9245810031913757`*^9}, {3.924586351811544*^9, 
   3.924586358907415*^9}, {3.924769117866547*^9, 3.9247691182492733`*^9}},
 CellLabel->"In[14]:=",ExpressionUUID->"be0436b8-3507-4c15-86dd-d8fd82d7c1ef"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", "Coefficients", " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Del", "[", 
    SubscriptBox["x_", "y_"], "]"}], ":=", "0"}]}]], "Input",
 CellChangeTimes->{{3.924740772153796*^9, 3.924740782370994*^9}},
 CellLabel->"In[19]:=",ExpressionUUID->"5111e1e7-ccc5-429d-a8b4-9fb31131e2e0"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.924840238977827*^9, 3.924840239342329*^9}},
 CellLabel->"In[20]:=",ExpressionUUID->"f94e76ce-4848-4cf2-92a5-a47b3c8823aa"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Setup", " ", "of"}], ",", " ", 
    RowBox[{"e", ".", "g", "."}], ",", " ", 
    RowBox[{"Lattice", " ", "Axion", " ", "QED"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"dim", "=", "4"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"x", " ", "cup"}], "-", 
     RowBox[{"0", " ", "y", " ", "cup"}], "-", 
     RowBox[{"0", " ", "z", " ", "OR", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"x", " ", "cup"}], "-", 
            RowBox[{"i", " ", "y"}]}], ")"}], " ", "cup"}], "-", 
         RowBox[{"j", " ", "z"}]}], ",", " ", 
        RowBox[{
         RowBox[{"x", " ", "cup"}], "-", 
         RowBox[{"i", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"y", " ", "cup"}], "-", "j"}], ")"}], " ", "z"}]}]}], 
       "}"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"creatTwoCups", "[", 
     RowBox[{"x_", ",", "dim_"}], "]"}], ":=", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Length", "[", "x", "]"}], "==", "3"}], ",", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"formnum", ",", "termnum"}], "}"}], ",", " ", 
        RowBox[{
         RowBox[{"termnum", "=", 
          RowBox[{"Length", "[", "x", "]"}]}], ";", 
         RowBox[{"formnum", "=", 
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{"nform", "[", 
             RowBox[{"x", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "termnum"}], "}"}]}], "]"}]}], ";", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"formnum", "==", "dim"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"Cup", "@@", "x"}], ")"}], "[", 
             RowBox[{"Table", "[", 
              RowBox[{"0", ",", " ", 
               RowBox[{"termnum", "-", "1"}]}], "]"}], "]"}], "}"}], ",", " ", 
           RowBox[{"Flatten", "[", 
            RowBox[{
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Cup", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Cup", "[", 
                    RowBox[{
                    RowBox[{"x", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"x", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "[", 
                    RowBox[{"{", "k", "}"}], "]"}], ",", 
                    RowBox[{"x", "[", 
                    RowBox[{"[", "3", "]"}], "]"}]}], "]"}], "[", 
                  RowBox[{"{", 
                   RowBox[{"formnum", "-", "dim", "-", "k"}], "}"}], "]"}], 
                 ",", " ", 
                 RowBox[{
                  RowBox[{"Cup", "[", 
                   RowBox[{
                    RowBox[{"x", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"Cup", "[", 
                    RowBox[{
                    RowBox[{"x", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{"x", "[", 
                    RowBox[{"[", "3", "]"}], "]"}]}], "]"}], "[", 
                    RowBox[{"{", "k", "}"}], "]"}]}], "]"}], "[", 
                  RowBox[{"{", 
                   RowBox[{"formnum", "-", "dim", "-", "k"}], "}"}], "]"}]}], 
                "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"k", ",", "0", ",", 
                 RowBox[{"formnum", "-", "dim"}]}], "}"}]}], "]"}], ",", 
             "1"}], "]"}]}], "]"}]}]}], "]"}]}], "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"E", ".", "g", "."}], ",", " ", 
     RowBox[{
     "Field", " ", "components", " ", "for", " ", "axion", " ", "QED", 
      "\[IndentingNewLine]", 
      RowBox[{"Axion", ":", " ", 
       RowBox[{"\[Phi]", "[", "0", "]"}]}]}], ",", " ", 
     RowBox[{
      RowBox[{"\[Delta]\[Phi]", "[", "1", "]"}], "=", 
      RowBox[{
       RowBox[{"\[Del]", "*", 
        RowBox[{"\[Phi]", "[", "0", "]"}]}], "+", 
       RowBox[{"l", "[", "1", "]"}]}]}], ",", " ", 
     RowBox[{"Photon", ":", " ", 
      RowBox[{"a", "[", "1", "]"}]}], ",", " ", 
     RowBox[{
      RowBox[{"f", "[", "2", "]"}], "=", 
      RowBox[{
       RowBox[{"\[Delta]a", "[", "2", "]"}], "=", 
       RowBox[{
        RowBox[{"\[Del]", "*", 
         RowBox[{"a", "[", "1", "]"}]}], "+", 
        RowBox[{"z", "[", "2", "]"}]}]}]}]}], "\[IndentingNewLine]", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"axions", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\[Phi]", "[", "0", "]"}], ",", " ", 
       RowBox[{"l", "[", "1", "]"}], ",", " ", 
       RowBox[{"Del", "[", 
        RowBox[{"\[Phi]", "[", "0", "]"}], "]"}], ",", " ", 
       RowBox[{"Del", "[", 
        RowBox[{"l", "[", "1", "]"}], "]"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"photons", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"a", "[", "1", "]"}], ",", " ", 
       RowBox[{"z", "[", "2", "]"}], ",", " ", 
       RowBox[{"Del", "[", 
        RowBox[{"a", "[", "1", "]"}], "]"}], ",", " ", 
       RowBox[{"Del", "[", 
        RowBox[{"z", "[", "2", "]"}], "]"}]}], "}"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.924837978979432*^9, 3.924838012392536*^9}, {
  3.924839148309596*^9, 3.924839171903425*^9}, {3.9248402511207647`*^9, 
  3.924840251502561*^9}, {3.924843350748698*^9, 3.924843351612638*^9}, {
  3.924843563636179*^9, 3.924843614315692*^9}, {3.924847584357375*^9, 
  3.924847585980163*^9}, {3.9248512390535603`*^9, 3.924851240438911*^9}, {
  3.943351310705338*^9, 3.943351349018613*^9}, {3.943351516965946*^9, 
  3.9433515214576406`*^9}},ExpressionUUID->"6ea8b200-a994-4bcd-b7fc-\
40a8cc5c8e75"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Axion", " ", "coupling", " ", "combinations", " ", "based", " ", "on", 
    " ", "the", " ", "form", " ", "\[Phi]FF"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Flatten", "[", 
     RowBox[{
      RowBox[{"Permutations", "/@", 
       RowBox[{"Tuples", "[", 
        RowBox[{"{", 
         RowBox[{"axions", ",", "photons", ",", "photons"}], "}"}], "]"}]}], 
      ",", "1"}], "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"DeleteCases", "[", 
     RowBox[{"%", ",", " ", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"x_", ",", "y_", ",", "z_"}], "}"}], "/;", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"nform", "[", "x", "]"}], "+", 
          RowBox[{"nform", "[", "y", "]"}], "+", 
          RowBox[{"nform", "[", "z", "]"}]}], ")"}], "<", "dim"}]}]}], "]"}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"DeleteCases", "[", 
     RowBox[{"%", ",", " ", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"x_", ",", "y_", ",", "z_"}], "}"}], "/;", 
       RowBox[{
        RowBox[{
         RowBox[{"x", "[", 
          RowBox[{"[", "0", "]"}], "]"}], "===", "Del"}], "&&", 
        RowBox[{
         RowBox[{"y", "[", 
          RowBox[{"[", "0", "]"}], "]"}], "===", "Del"}], "&&", 
        RowBox[{
         RowBox[{"z", "[", 
          RowBox[{"[", "0", "]"}], "]"}], "===", "Del"}]}]}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Flatten", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"creatTwoCups", "[", 
         RowBox[{"#", ",", "dim"}], "]"}], "&"}], "/@", "%"}], ",", "1"}], 
     "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"axionCouplingList", "=", 
     RowBox[{"DeleteDuplicates", "[", 
      RowBox[{"Prepend", "[", 
       RowBox[{"%", ",", 
        RowBox[{
         RowBox[{"Cup", "[", 
          RowBox[{
           RowBox[{"Del", "[", 
            RowBox[{"\[Phi]", "[", "0", "]"}], "]"}], ",", 
           RowBox[{
            RowBox[{"Cup", "[", 
             RowBox[{
              RowBox[{"\[Del]", 
               RowBox[{"a", "[", "1", "]"}]}], ",", 
              RowBox[{"\[Del]", 
               RowBox[{"a", "[", "1", "]"}]}]}], "]"}], "[", 
            RowBox[{"{", "1", "}"}], "]"}]}], "]"}], "[", 
         RowBox[{"{", "0", "}"}], "]"}]}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"action", " ", "=", " ", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{
        SubscriptBox["c", "i"], " ", 
        RowBox[{"%", "[", 
         RowBox[{"[", "i", "]"}], "]"}]}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "%", "]"}]}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Length", "[", "axionCouplingList", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.924837599669982*^9, 3.9248376116059217`*^9}, {
   3.924837752762298*^9, 3.924837755835005*^9}, {3.9248377968784533`*^9, 
   3.924837819646722*^9}, {3.9248380253979187`*^9, 3.9248380475337543`*^9}, {
   3.9248381084103603`*^9, 3.924838123402894*^9}, {3.9248383496332607`*^9, 
   3.9248383814353037`*^9}, {3.9248384132524567`*^9, 3.92483841582621*^9}, {
   3.924838562419585*^9, 3.9248385862394238`*^9}, {3.924838622610067*^9, 
   3.924838628200198*^9}, {3.9248387215799*^9, 3.924838754144413*^9}, {
   3.924838796236104*^9, 3.92483880150949*^9}, {3.9248388951251497`*^9, 
   3.924838922464396*^9}, {3.924839061143835*^9, 3.924839069790531*^9}, {
   3.924839134706115*^9, 3.9248391454447603`*^9}, {3.924839177247332*^9, 
   3.924839177499998*^9}, {3.924839246216196*^9, 3.9248393041819363`*^9}, {
   3.924839588804171*^9, 3.9248396954209948`*^9}, {3.924839777913636*^9, 
   3.924839865395413*^9}, {3.9248399164892178`*^9, 3.9248399424286547`*^9}, {
   3.924840094591854*^9, 3.9248400957242928`*^9}, {3.924840128888385*^9, 
   3.924840129552648*^9}, 3.924840166300335*^9, {3.924840270274728*^9, 
   3.924840273360106*^9}, 3.924840320537384*^9, {3.924840510919693*^9, 
   3.924840534135194*^9}, 3.9248408829853287`*^9, 3.9248433282238007`*^9, {
   3.924843387768407*^9, 3.924843418267467*^9}, {3.9248434633634653`*^9, 
   3.924843472421999*^9}, {3.924843519621277*^9, 3.924843520819377*^9}, {
   3.9248436399878597`*^9, 3.924843644443038*^9}, {3.924843678757702*^9, 
   3.924843682466435*^9}, {3.9248438057931643`*^9, 3.924843885390698*^9}, {
   3.924845949323718*^9, 3.924845961841606*^9}, {3.924847268026332*^9, 
   3.924847271847391*^9}, {3.924847365599275*^9, 3.9248473715774317`*^9}, {
   3.924902234928405*^9, 3.9249022414707327`*^9}, {3.924902502372143*^9, 
   3.924902554544215*^9}, {3.924902735369124*^9, 3.924902738679686*^9}, {
   3.924902813863371*^9, 3.924902883683103*^9}, {3.924902985036613*^9, 
   3.924902998555705*^9}, {3.924907185505866*^9, 3.9249072339826593`*^9}, {
   3.9249104586691093`*^9, 3.924910463572384*^9}, {3.924910506227426*^9, 
   3.924910512251007*^9}, {3.924910981884828*^9, 3.9249109948591957`*^9}, {
   3.9249110252588673`*^9, 3.924911033106124*^9}, {3.9249211246128073`*^9, 
   3.924921160550693*^9}, {3.924921207761345*^9, 3.924921226220891*^9}, {
   3.924921309529872*^9, 3.924921324585003*^9}, {3.926144657239456*^9, 
   3.9261446774462957`*^9}, {3.92614534475739*^9, 3.926145346938385*^9}, {
   3.92614551368559*^9, 3.9261455169736013`*^9}, {3.926145733526002*^9, 
   3.926145767287862*^9}, {3.9261458140646667`*^9, 3.926145816393165*^9}, {
   3.943351386212936*^9, 
   3.943351389145712*^9}},ExpressionUUID->"d56b1acc-c56a-431d-98e3-\
077c64bf92a4"],

Cell[BoxData["562"], "Output",
 CellChangeTimes->{
  3.924847278121375*^9, 3.924847430757259*^9, 3.9248474638113747`*^9, 
   3.924847520649832*^9, 3.924848072248867*^9, 3.924848215356262*^9, 
   3.924850207640603*^9, 3.9248504143769712`*^9, 3.9248509865561533`*^9, 
   3.924852383705909*^9, 3.92485243818191*^9, 3.9248524955883703`*^9, 
   3.9248530754728518`*^9, 3.924854289152884*^9, 3.924857216927311*^9, 
   3.924902150494438*^9, 3.924902254752013*^9, 3.9249025654817677`*^9, 
   3.92490274887899*^9, 3.924902887354989*^9, 3.924903000058319*^9, 
   3.924903030964731*^9, 3.92490723764065*^9, 3.924908377558682*^9, 
   3.9249104713311462`*^9, 3.924910513646964*^9, 3.9249106050209093`*^9, {
   3.924911007553852*^9, 3.924911035684387*^9}, 3.924921236926503*^9, 
   3.9249213418794327`*^9, 3.925951190440422*^9, 3.9259513649751463`*^9, 
   3.925955804032865*^9, 3.925959356375587*^9, 3.926144724287766*^9, 
   3.926145348537506*^9, 3.926145517974*^9, 3.926145768454391*^9, 
   3.926145816930078*^9},
 CellLabel->
  "Out[193]=",ExpressionUUID->"0f58976f-90d4-421a-b31a-32ab8b85e7db"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Implementation", " ", "of", " ", "gauge", " ", "invariance"}], 
   " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"coeffEquality", "[", 
     RowBox[{"s_", ",", "gt_", ",", "cup_", ",", "numcoeff_", ",", 
      RowBox[{"dynm_", ":", "0"}], ",", 
      RowBox[{"printS_", ":", "0"}]}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"transfS0", ",", "transfS", ",", "clist"}], "}"}], ",", 
      RowBox[{
       RowBox[{"transfS0", "=", 
        RowBox[{"Collect", "[", 
         RowBox[{"(*", 
          RowBox[{"Del", "/@"}], "*)"}], 
         RowBox[{
          RowBox[{"Expand", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"s", "/.", "gt"}], ")"}], " ", "-", " ", "s"}], "]"}], 
          ",", "cup"}], "]"}]}], ";", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"dynm", "==", "1"}], ",", 
         RowBox[{"transfS", "=", 
          RowBox[{"transfS0", "-", 
           RowBox[{"(", 
            RowBox[{"transfS0", "/.", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"\[Phi]", "[", "0", "]"}], "->", "0"}], ",", 
               RowBox[{
                RowBox[{"a", "[", "1", "]"}], "->", "0"}]}], "}"}]}], 
            ")"}]}]}], ",", 
         RowBox[{"transfS", "=", "transfS0"}]}], "]"}], ";", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"printS", "==", "1"}], ",", 
         RowBox[{"Print", "[", "transfS", "]"}]}], "]"}], ";", 
       RowBox[{"clist", "=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"List", "@@", "transfS"}], ")"}], "/.", 
         RowBox[{
          RowBox[{
           RowBox[{"Cup", "[", "x__", "]"}], "[", "i__", "]"}], ":>", 
          "1"}]}]}], ";", 
       RowBox[{"Reduce", "[", 
        RowBox[{
         RowBox[{"And", "@@", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"clist", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "==", "0"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", 
              RowBox[{"Length", "[", "clist", "]"}]}], "}"}]}], "]"}]}], ",", 
         
         RowBox[{"Table", "[", 
          RowBox[{
           SubscriptBox["c", "i"], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "numcoeff"}], "}"}]}], "]"}]}], "]"}]}]}], 
     "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"coeffCobdryEquality", "[", 
     RowBox[{"s_", ",", "gt_", ",", "cup_", ",", "numcoeff_", ",", 
      RowBox[{"dynm_", ":", "0"}], ",", 
      RowBox[{"printS_", ":", "0"}]}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"transfS0", ",", "transfS", ",", "clist"}], "}"}], ",", 
      RowBox[{
       RowBox[{"transfS0", "=", 
        RowBox[{"Collect", "[", 
         RowBox[{
          RowBox[{"Del", "/@", 
           RowBox[{"Expand", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"s", "/.", "gt"}], ")"}], " ", "-", " ", "s"}], "]"}]}],
           ",", "cup"}], "]"}]}], ";", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"dynm", "==", "1"}], ",", 
         RowBox[{"transfS", "=", 
          RowBox[{"transfS0", "-", 
           RowBox[{"(", 
            RowBox[{"transfS0", "/.", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"\[Phi]", "[", "0", "]"}], "->", "0"}], ",", 
               RowBox[{
                RowBox[{"a", "[", "1", "]"}], "->", "0"}]}], "}"}]}], 
            ")"}]}]}], ",", 
         RowBox[{"transfS", "=", "transfS0"}]}], "]"}], ";", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"printS", "==", "1"}], ",", 
         RowBox[{"Print", "[", "transfS", "]"}]}], "]"}], ";", 
       RowBox[{"clist", "=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"List", "@@", "transfS"}], ")"}], "/.", 
         RowBox[{
          RowBox[{
           RowBox[{"Cup", "[", "x__", "]"}], "[", "i__", "]"}], ":>", 
          "1"}]}]}], ";", 
       RowBox[{"Reduce", "[", 
        RowBox[{
         RowBox[{"And", "@@", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"clist", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "==", "0"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", 
              RowBox[{"Length", "[", "clist", "]"}]}], "}"}]}], "]"}]}], ",", 
         
         RowBox[{"Table", "[", 
          RowBox[{
           SubscriptBox["c", "i"], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "numcoeff"}], "}"}]}], "]"}]}], "]"}]}]}], 
     "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.924840553248975*^9, 3.924840584312085*^9}, {
   3.924840626150634*^9, 3.924840733310122*^9}, {3.924840792250738*^9, 
   3.924840861371613*^9}, {3.924840910510056*^9, 3.924840971200872*^9}, {
   3.924841022213154*^9, 3.924841063681781*^9}, {3.924841119183969*^9, 
   3.924841126269973*^9}, {3.92484123684728*^9, 3.924841244945384*^9}, {
   3.92484130246518*^9, 3.924841339955022*^9}, {3.924841400957243*^9, 
   3.92484143358068*^9}, 3.924841475468172*^9, {3.924841566281159*^9, 
   3.924841735435841*^9}, {3.924841778046917*^9, 3.924841863644239*^9}, {
   3.9248420385102997`*^9, 3.924842095191375*^9}, {3.924842149252087*^9, 
   3.924842167057683*^9}, {3.924842312248624*^9, 3.924842349733869*^9}, {
   3.9248424371822853`*^9, 3.924842479098955*^9}, {3.924842556831275*^9, 
   3.924842636838131*^9}, {3.924842700028961*^9, 3.9248428807279177`*^9}, {
   3.92484293241323*^9, 3.9248430124143753`*^9}, {3.924843133626032*^9, 
   3.924843181811108*^9}, 3.92484334800735*^9, {3.924843904508047*^9, 
   3.9248441501716022`*^9}, {3.924845967242725*^9, 3.9248459832324867`*^9}, {
   3.924846037878553*^9, 3.924846048584467*^9}, {3.924846142950913*^9, 
   3.924846196001596*^9}, {3.924846296553018*^9, 3.924846408899569*^9}, {
   3.924846444698621*^9, 3.924846571330443*^9}, {3.9248467195280724`*^9, 
   3.924846747991028*^9}, {3.924846974972041*^9, 3.924847048273739*^9}, {
   3.9248471352736177`*^9, 3.9248471791357937`*^9}, {3.92484725184056*^9, 
   3.924847265041362*^9}, {3.924847308843598*^9, 3.924847327753829*^9}, {
   3.9248473755767508`*^9, 3.9248474167130327`*^9}, {3.924848965234172*^9, 
   3.924849190768868*^9}, {3.924849365628957*^9, 3.9248493774110537`*^9}, {
   3.92484942609022*^9, 3.924849613026594*^9}, {3.924849720215643*^9, 
   3.9248497392751904`*^9}, {3.924849825336135*^9, 3.9248498686077957`*^9}, {
   3.9248499768295937`*^9, 3.924850007136236*^9}, {3.9248500650530987`*^9, 
   3.924850075043221*^9}, {3.924850127775568*^9, 3.924850134356847*^9}, {
   3.924850177311108*^9, 3.924850181248137*^9}, {3.924850766299776*^9, 
   3.924850939324088*^9}, {3.9248523674395323`*^9, 3.92485237088903*^9}, {
   3.924852424195807*^9, 3.9248524282732363`*^9}, {3.924852737171335*^9, 
   3.924852742167762*^9}, {3.924853014181292*^9, 3.9248530149290667`*^9}, 
   3.924857207702573*^9, {3.924909669590301*^9, 3.9249096859485703`*^9}, {
   3.9249098062017*^9, 3.924909836320519*^9}, 3.924909890423365*^9, 
   3.924909927813616*^9, {3.924909981276122*^9, 3.924910036722457*^9}, {
   3.924910121304645*^9, 3.924910136462472*^9}, {3.924911182359316*^9, 
   3.924911191206497*^9}, {3.9433514891985598`*^9, 
   3.943351490151589*^9}},ExpressionUUID->"131d0e80-5590-41c5-80cf-\
f977dd6d6a4c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"coeffGenuineEquality", "[", 
   RowBox[{
   "s_", ",", "gt_", ",", "cup_", ",", "wouldbe0_", ",", "numcoeff_", ",", 
    RowBox[{"dynm_", ":", "0"}], ",", 
    RowBox[{"printS_", ":", "0"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"transfS0", ",", "transfS", ",", "clist"}], "}"}], ",", 
    RowBox[{
     RowBox[{"transfS0", "=", 
      RowBox[{"Collect", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Expand", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"s", "/.", "gt"}], ")"}], " ", "-", " ", "s"}], "]"}], "/.", 
          RowBox[{"wouldbe0", "->", "0"}]}], ")"}], ",", "cup"}], "]"}]}], 
     ";", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"dynm", "==", "1"}], ",", 
       RowBox[{"transfS", "=", 
        RowBox[{"transfS0", "-", 
         RowBox[{"(", 
          RowBox[{"transfS0", "/.", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"\[Phi]", "[", "0", "]"}], "->", "0"}], ",", 
             RowBox[{
              RowBox[{"a", "[", "1", "]"}], "->", "0"}]}], "}"}]}], ")"}]}]}],
        ",", 
       RowBox[{"transfS", "=", "transfS0"}]}], "]"}], ";", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"printS", "==", "1"}], ",", 
       RowBox[{"Print", "[", "transfS", "]"}]}], "]"}], ";", 
     RowBox[{"clist", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"List", "@@", "transfS"}], ")"}], "/.", 
       RowBox[{
        RowBox[{
         RowBox[{"Cup", "[", "x__", "]"}], "[", "i__", "]"}], ":>", "1"}]}]}],
      ";", 
     RowBox[{"Reduce", "[", 
      RowBox[{
       RowBox[{"And", "@@", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"clist", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "==", "0"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"Length", "[", "clist", "]"}]}], "}"}]}], "]"}]}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{
         SubscriptBox["c", "i"], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "numcoeff"}], "}"}]}], "]"}]}], "]"}]}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.92614505955405*^9, 3.926145062135837*^9}, 
   3.9261451141726093`*^9, {3.9261451980946827`*^9, 3.926145273307022*^9}},
 CellLabel->
  "In[207]:=",ExpressionUUID->"cee3f2fb-e16d-45c0-8283-f7c8a824e888"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"R", " ", "0"}], "-", 
    RowBox[{"form", " ", "gauge", " ", "transformation"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"gaugeTransfR0", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"a", "[", "1", "]"}], "->", 
       RowBox[{
        RowBox[{"a", "[", "1", "]"}], "+", 
        RowBox[{"Del", "[", 
         RowBox[{"\[Lambda]", "[", "0", "]"}], "]"}]}]}], "}"}]}], ";", 
    RowBox[{"Flatten", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"axionCouplingList", "/.", "gaugeTransfR0"}], "/.", 
       RowBox[{"Plus", "->", "List"}]}], ",", "1"}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Lambda]CouplingList", "=", 
     RowBox[{"Complement", "[", 
      RowBox[{
       RowBox[{"DeleteDuplicates", "[", "%", "]"}], ",", 
       "axionCouplingList"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"Z", " ", "1"}], "-", 
     RowBox[{"form", " ", "gauge", " ", "transformation"}]}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"gaugeTransfZ1", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"a", "[", "1", "]"}], "->", 
        RowBox[{
         RowBox[{"a", "[", "1", "]"}], "+", 
         RowBox[{"m", "[", "1", "]"}]}]}], ",", " ", 
       RowBox[{
        RowBox[{"z", "[", "2", "]"}], "->", 
        RowBox[{
         RowBox[{"z", "[", "2", "]"}], "-", 
         RowBox[{"Del", "[", 
          RowBox[{"m", "[", "1", "]"}], "]"}]}]}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Flatten", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"axionCouplingList", "/.", 
        RowBox[{"(", 
         RowBox[{"gaugeTransfZ1", "/.", 
          RowBox[{
           RowBox[{"Del", "[", 
            RowBox[{"m", "[", "1", "]"}], "]"}], "->", 
           RowBox[{"-", 
            RowBox[{"Del", "[", 
             RowBox[{"m", "[", "1", "]"}], "]"}]}]}]}], ")"}]}], " ", "/.", 
       RowBox[{"Plus", "->", "List"}]}], ",", "1"}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"mCouplingList", "=", 
     RowBox[{"Complement", "[", 
      RowBox[{
       RowBox[{"DeleteDuplicates", "[", "%", "]"}], ",", 
       "axionCouplingList"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"mCobdryCouplingList", "=", 
     RowBox[{"DeleteDuplicates", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"Del", "/@", "mCouplingList"}], ")"}], "/.", 
        RowBox[{"Plus", "\[Rule]", "List"}]}], "/.", 
       RowBox[{
        RowBox[{"-", "1"}], "\[Rule]", "1"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"Z", " ", "0"}], "-", 
     RowBox[{"form", " ", "gauge", " ", "transformation"}]}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"gaugeTransfZ0", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"\[Phi]", "[", "0", "]"}], "->", 
        RowBox[{
         RowBox[{"\[Phi]", "[", "0", "]"}], "+", 
         RowBox[{"\[Kappa]", "[", "0", "]"}]}]}], ",", " ", 
       RowBox[{
        RowBox[{"l", "[", "1", "]"}], "->", 
        RowBox[{
         RowBox[{"l", "[", "1", "]"}], "-", 
         RowBox[{"Del", "[", 
          RowBox[{"\[Kappa]", "[", "0", "]"}], "]"}]}]}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Flatten", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"axionCouplingList", "/.", 
        RowBox[{"(", 
         RowBox[{"gaugeTransfZ0", "/.", 
          RowBox[{
           RowBox[{"Del", "[", 
            RowBox[{"\[Kappa]", "[", "0", "]"}], "]"}], "->", 
           RowBox[{"-", 
            RowBox[{"Del", "[", 
             RowBox[{"\[Kappa]", "[", "0", "]"}], "]"}]}]}]}], ")"}]}], "/.", 
       
       RowBox[{"Plus", "->", "List"}]}], ",", "1"}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Kappa]CouplingList", "=", 
     RowBox[{"Complement", "[", 
      RowBox[{
       RowBox[{"DeleteDuplicates", "[", "%", "]"}], ",", 
       "axionCouplingList"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Kappa]CobdryCouplingList", "=", 
     RowBox[{"DeleteDuplicates", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"Del", "/@", "\[Kappa]CouplingList"}], ")"}], "/.", 
        RowBox[{"Plus", "\[Rule]", "List"}]}], "/.", 
       RowBox[{
        RowBox[{"-", "1"}], "\[Rule]", "1"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Length", "/@", 
    RowBox[{"{", 
     RowBox[{
     "\[Lambda]CouplingList", ",", "mCouplingList", ",", 
      "\[Kappa]CouplingList"}], "}"}]}]}]}]], "Input",ExpressionUUID->\
"f6ea3df1-992f-4d0d-9236-3a0c28c82c4a"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.9433515609503593`*^9, 
  3.9433515619784946`*^9}},ExpressionUUID->"bd8c04da-dc0f-4421-84bb-\
69a2f7eefd2a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"coeffEqR0List", "=", 
   RowBox[{"coeffEquality", "[", 
    RowBox[{"action", ",", "gaugeTransfR0", ",", "\[Lambda]CouplingList", ",", 
     RowBox[{"Length", "[", "axionCouplingList", "]"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{
  3.943351840913026*^9},ExpressionUUID->"48eb5f14-8392-45f4-8a31-\
183d586a1d33"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"coeffEqZ1List", "=", 
     RowBox[{"coeffEquality", "[", 
      RowBox[{"action", ",", "gaugeTransfZ1", ",", "mCouplingList", ",", 
       RowBox[{"Length", "[", "axionCouplingList", "]"}], ",", "1", ",", 
       "1"}], "]"}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"coeffEqZ1List", "=", 
     RowBox[{"coeffGenuineEquality", "[", 
      RowBox[{"action", ",", "gaugeTransfZ1", ",", "mCouplingList", ",", 
       RowBox[{"Del", "[", 
        RowBox[{"z", "[", "2", "]"}], "]"}], ",", 
       RowBox[{"Length", "[", "axionCouplingList", "]"}], ",", "1"}], "]"}]}],
     ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"coeffEqZ1List", "=", 
      RowBox[{"coeffCobdryEquality", "[", 
       RowBox[{
       "action", ",", "gaugeTransfZ1", ",", "mCobdryCouplingList", ",", 
        RowBox[{"Length", "[", "axionCouplingList", "]"}], ",", "1"}], 
       "]"}]}], ";"}], "*)"}]}]}]], "Input",
 CellChangeTimes->{{3.943351753491344*^9, 
  3.943351762592782*^9}},ExpressionUUID->"b79f1db0-2e79-4d6f-9e1b-\
ac49f0086209"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"coeffEqZ0List", "=", 
     RowBox[{"coeffEquality", "[", 
      RowBox[{
      "action", ",", "gaugeTransfZ0", ",", "\[Kappa]CouplingList", ",", 
       RowBox[{"Length", "[", "axionCouplingList", "]"}], ",", "1"}], "]"}]}],
     ";"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"coeffEqZ0List", "=", 
    RowBox[{"coeffCobdryEquality", "[", 
     RowBox[{
     "action", ",", "gaugeTransfZ0", ",", "\[Kappa]CobdryCouplingList", ",", 
      RowBox[{"Length", "[", "axionCouplingList", "]"}], ",", "1"}], "]"}]}], 
   ";"}]}]], "Input",ExpressionUUID->"67279153-80e6-480a-ae4f-7082c8336143"]
},
WindowSize->{808, 816},
WindowMargins->{{Automatic, 70}, {Automatic, 0}},
TaggingRules-><|"TryRealOnly" -> False|>,
FrontEndVersion->"13.0 for Mac OS X ARM (64-bit) (February 4, 2022)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"0c67e930-a1dc-4fe5-b134-f43d076feabe"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 1014, 28, 73, "Input",ExpressionUUID->"142e26fa-910b-44b6-a90a-b05fb8915a21"],
Cell[1575, 50, 4224, 100, 241, "Input",ExpressionUUID->"72ffa93e-3d60-4328-9f73-fca678062c06"],
Cell[5802, 152, 1766, 37, 73, "Input",ExpressionUUID->"84a0f371-491f-495e-acf4-f3c1fe35a6f5"],
Cell[7571, 191, 2624, 64, 115, "Input",ExpressionUUID->"f5fa3ec9-7584-414c-9149-5288673aa29c"],
Cell[10198, 257, 8973, 191, 283, "Input",ExpressionUUID->"be0436b8-3507-4c15-86dd-d8fd82d7c1ef"],
Cell[19174, 450, 339, 7, 55, "Input",ExpressionUUID->"5111e1e7-ccc5-429d-a8b4-9fb31131e2e0"],
Cell[19516, 459, 171, 2, 30, "Input",ExpressionUUID->"f94e76ce-4848-4cf2-92a5-a47b3c8823aa"],
Cell[19690, 463, 6163, 160, 325, "Input",ExpressionUUID->"6ea8b200-a994-4bcd-b7fc-40a8cc5c8e75"],
Cell[CellGroupData[{
Cell[25878, 627, 5627, 124, 199, "Input",ExpressionUUID->"d56b1acc-c56a-431d-98e3-077c64bf92a4"],
Cell[31508, 753, 1084, 17, 34, "Output",ExpressionUUID->"0f58976f-90d4-421a-b31a-32ab8b85e7db"]
}, Open  ]],
Cell[32607, 773, 7457, 172, 304, "Input",ExpressionUUID->"131d0e80-5590-41c5-80cf-f977dd6d6a4c"],
Cell[40067, 947, 2454, 70, 157, "Input",ExpressionUUID->"cee3f2fb-e16d-45c0-8283-f7c8a824e888"],
Cell[42524, 1019, 4813, 141, 325, "Input",ExpressionUUID->"f6ea3df1-992f-4d0d-9236-3a0c28c82c4a"],
Cell[47340, 1162, 156, 3, 30, "Input",ExpressionUUID->"bd8c04da-dc0f-4421-84bb-69a2f7eefd2a"],
Cell[47499, 1167, 359, 9, 52, "Input",ExpressionUUID->"48eb5f14-8392-45f4-8a31-183d586a1d33"],
Cell[47861, 1178, 1144, 28, 136, "Input",ExpressionUUID->"b79f1db0-2e79-4d6f-9e1b-ac49f0086209"],
Cell[49008, 1208, 668, 16, 94, "Input",ExpressionUUID->"67279153-80e6-480a-ae4f-7082c8336143"]
}
]
*)

